--------------------------------------------------------
--  DDL for Package PG_DYNC_VALI
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE "CIFX"."PG_DYNC_VALI" AS

      PROCEDURE SP_TEST(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_046(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

      PROCEDURE SP_V_047(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_048(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_049(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_050(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_051(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_052(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_053(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_054(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_055(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );


     PROCEDURE SP_V_056(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_057(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );
     PROCEDURE SP_V_058(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_059(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_060(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_061(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );


     PROCEDURE SP_V_062(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );



     PROCEDURE SP_V_063(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_064(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_065(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_066(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_067(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_068(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_069(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );


     PROCEDURE SP_V_070(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_071(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );


     PROCEDURE SP_V_072(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_073(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );


     PROCEDURE SP_V_074(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );

     PROCEDURE SP_V_075(
     I_INPUT_JSON IN CLOB,
     I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
     I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
     I_TX_ID IN VARCHAR2,
     I_SENDER_CODE IN VARCHAR2,
     I_CERT_TYPE IN VARCHAR2,
     I_CHANGE_TYPE IN VARCHAR2
      );



END PG_DYNC_VALI;

/
--------------------------------------------------------
--  DDL for Package Body PG_DYNC_VALI
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE PACKAGE BODY "CIFX"."PG_DYNC_VALI" AS
  PROCEDURE SP_TEST(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )
  IS
  input_cust_jo  json_object_t ;
  BEGIN
  DBMS_OUTPUT.PUT_LINE('============ SP_TEST TEST START =======');
  DBMS_OUTPUT.PUT_LINE('I_INPUT_JSON:'||I_INPUT_JSON);
  DBMS_OUTPUT.PUT_LINE('I_TB_CUSTOMER.CUST_NAME:'||I_TB_CUSTOMER.CUST_NAME);

  DBMS_OUTPUT.PUT_LINE('I_TB_CUSTOMER.CNTP_COMM_CONTENT:' ||I_TB_CUSTOMER.CNTP_COMM_CONTENT);
  DBMS_OUTPUT.PUT_LINE('I_tb_customer_after.CNTP_COMM_CONTENT:' ||I_tb_customer_after.CNTP_COMM_CONTENT);

  DBMS_OUTPUT.PUT_LINE('============ SP_TEST TEST END =======');
  END SP_TEST
  ;

  /**
    ﹝大陸商註記主代碼﹞及﹝註冊國別代碼﹞的組合符合下列任一條件時，設定﹝執行結果﹞為「$122」(回傳前端: 7136)
    ﹝大陸商註記主代碼﹞ ﹝註冊國別代碼﹞
    「1 : 非大陸商」 「CN : 大陸」
    「2 : 大陸台資」 ≠「CN : 大陸」
    「3 : 在台大陸商」 ≠「TW : 台灣」
    「4 : 第三地大陸商」 「CN : 大陸」或「TW : 台灣」
    「5 : 大陸外資法人」 ≠「CN : 大陸」
    「6 : 大陸中央法人」 ≠「CN : 大陸」
    「7 : 大陸其他法人」 ≠「CN : 大陸」
  */
  PROCEDURE SP_V_046(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )IS
  validation_fail boolean := false;
  BEGIN
  DBMS_OUTPUT.PUT_LINE('============ SP_V_046 START =========');
  if I_CERT_TYPE in ('B','OB') then
  case
     when  nvl(I_tb_customer_after.CHINA_MASTER_CODE,' ') = '1' and nvl(I_tb_customer_after.REG_COUNTRY_CODE,' ')  = 'CN'  then  validation_fail := true;
     when  nvl(I_tb_customer_after.CHINA_MASTER_CODE,' ') = '2' and nvl(I_tb_customer_after.REG_COUNTRY_CODE,' ')  <> 'CN'  then  validation_fail := true;
     when  nvl(I_tb_customer_after.CHINA_MASTER_CODE,' ') = '3' and nvl(I_tb_customer_after.REG_COUNTRY_CODE,' ')  <> 'TW'  then  validation_fail := true;
     when  nvl(I_tb_customer_after.CHINA_MASTER_CODE,' ') = '4' and nvl(I_tb_customer_after.REG_COUNTRY_CODE,' ')  not in  ('CN','TW')  then  validation_fail := true;
     when  nvl(I_tb_customer_after.CHINA_MASTER_CODE,' ') = '5' and nvl(I_tb_customer_after.REG_COUNTRY_CODE,' ')  <>  'CN'  then  validation_fail := true;
     when  nvl(I_tb_customer_after.CHINA_MASTER_CODE,' ') = '6' and nvl(I_tb_customer_after.REG_COUNTRY_CODE,' ')  <>  'CN'  then  validation_fail := true;
     when  nvl(I_tb_customer_after.CHINA_MASTER_CODE,' ') = '7' and nvl(I_tb_customer_after.REG_COUNTRY_CODE,' ')  <>  'CN'  then  validation_fail := true;
     else
     null;
     end case;
     if validation_fail then
     CIFX.PG_THROW_ERR.SP_THROW_ERR('7136%$122');
     end if;
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_046 END =========');
  END SP_V_046;

  /*
  〔顧客性質別〕＝「0或6」，﹝大陸商註記子代碼﹞不可輸入，否則設定﹝執行結果﹞為﹝執行結果﹞為為「$151」(回傳前端: 7136)
  */
 PROCEDURE SP_V_047(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )IS
  BEGIN
  DBMS_OUTPUT.PUT_LINE('============ SP_V_047 START =========');
  if nvl(I_tb_customer_after.PROPERTY_TYPE_CODE,' ') in ('0','6' )
  and I_tb_customer_after.CHINA_MASTER_CODE is NOT null
  then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('7136%$151');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_047 END =========');
  END SP_V_047;

  /*
  ﹝原始身份證字號/統編﹞前2碼不是「NI:竹南信」且﹝國籍分類代碼﹞是「0 : 本國」時，設定﹝執行結果﹞為為「$119」(回傳前端: 0942)
  */
  PROCEDURE SP_V_048(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_048 START =========');
  if I_CERT_TYPE in ('E','F','G','H')
  and  substr(nvl(i_tb_customer_after.CIF_ORIGINAL_ID,' '),1,2) <> 'NI' and  nvl(i_tb_customer_after.NATIONALITY,' ') = '0' then
      CIFX.PG_THROW_ERR.SP_THROW_ERR('0942%$119');

  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_048 END =========');
  end SP_V_048;


  /*
  已停止使用聯徵虛擬統編建檔，﹝原始身份證字號/統編﹞前兩碼=「&&」則設定﹝執行結果﹞為「$178」(回傳前端: 5008)
  */
  PROCEDURE SP_V_049(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_049 START =========');
  if I_CERT_TYPE in ('OA','OB') and I_CHANGE_TYPE = 'C'
  and substr(nvl(i_tb_customer_after.CIF_ORIGINAL_ID,' '),1,2) = '&&' then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('5008%$178');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_049 END =========');
  end SP_V_049;

  /*
  "﹝原始身份證字號/統編﹞前2碼≠「NI」且﹝國籍分類代碼﹞是「1 : 居留證有效期間大於一年之自然人及取得我國證照之法人」，﹝利息所得稅別﹞必須符合下列任一選項
    A. 「1 : 本國人 10%」
    B. 「2 : 外國人20%」"
  */
  PROCEDURE SP_V_050(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_050 START =========');
  if I_CERT_TYPE in ('E','F','G','H')
  and substr(nvl(i_tb_customer_after.CIF_ORIGINAL_ID,' '),1,2) <> 'NI'
  and nvl(i_tb_customer_after.NATIONALITY,' ') = '1' and nvl(i_tb_customer_after.INCOME_TAX_TYPE,' ') in ('1','2')
  then
     CIFX.PG_THROW_ERR.SP_THROW_ERR('1401%$126');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_050 END =========');
  end SP_V_050;


  /*
  若上送小寫欄位，回傳錯誤代碼
  */
  PROCEDURE SP_V_051(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  lower_char_cnt integer := 0 ;
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_051 START =========');
    select count(1) into lower_char_cnt from dual
    where regexp_like(i_tb_customer_after.CIF_ORIGINAL_ID,'[[:lower:]]');

    if lower_char_cnt > 1 then
     CIFX.PG_THROW_ERR.SP_THROW_ERR('0918');
    end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_051 END =========');
  end SP_V_051;


  /*
   催理戶不可變更基本資料，參閱EDLS文件查詢存放款帳號資訊，並檢核是否為催理戶
  */
  PROCEDURE SP_V_052(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  v_cursor      SYS_REFCURSOR;
    --EDLS
  v_acc_type                      varchar2(200 char):=null; -- 帳號類別
  v_account	                      varchar2(200 char):=null; -- 帳號
  v_prod_code                     varchar2(200 char):=null; -- 產品代號
  v_acc_status	                  varchar2(200 char) :=null; -- 帳戶狀態
  v_esa_acc_mark                  varchar2(200 char):=null; -- ESA帳號註記
  v_sleeping_acc_mark             varchar2(200 char):=null; -- 久未往來註記
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_052 START =========');
  if I_TX_ID = 'createCorporateCust' then
      EDLS.PG_EDLS_TO_CIF.SP_GET_CUST_ACC_INFO(I_tb_customer_after.cif_verified_id,v_cursor);
      LOOP
        FETCH v_cursor
        INTO v_acc_type ,v_account , v_prod_code, v_acc_status ,v_esa_acc_mark ,v_sleeping_acc_mark;
        EXIT WHEN v_cursor%NOTFOUND;
       if v_acc_type in ('5','6') or v_acc_status in ('7','8') then
          CIFX.PG_THROW_ERR.SP_THROW_ERR('E024');
       end if;
      END LOOP;
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_052 END =========');
  end SP_V_052;


  /*
   "警示帳戶不可變更基本資料。【顧客主檔】.【顧客狀態代碼】為下列代碼時，設定﹝執行結果﹞為「E024」
    「34：警示帳戶－非屬電話詐財」
    「44：警示帳戶－電話詐財」
    「54：警示衍生戶」"
  */
  PROCEDURE SP_V_053(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_053 START =========');
  if I_TX_ID = 'createCorporateCust' then
     if nvl(I_TB_CUSTOMER.CUSTOMER_STATUS,' ') in ('34','44','54')then
      CIFX.PG_THROW_ERR.SP_THROW_ERR('E024');
     end if;
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_053 END =========');
  end SP_V_053;


  /*
  "警示帳戶不可變更基本資料。【顧客主檔】.【顧客狀態代碼】為下列代碼時，設定﹝執行結果﹞為「E024」
    「34：警示帳戶－非屬電話詐財」
    「44：警示帳戶－電話詐財」
    「54：警示衍生戶」"
  */
  PROCEDURE SP_V_054(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_054 START =========');
  if I_TX_ID = 'updateCustContact'
  and nvl(I_TB_CUSTOMER.CUSTOMER_STATUS,' ') in ('34','44','54')then
      CIFX.PG_THROW_ERR.SP_THROW_ERR('E024');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_054 END =========');
  end SP_V_054;



 /*
 "﹝顧客狀態代碼］＝Null時，下列任一欄位有值時，設定﹝執行結果﹞為「0918」
A. ［案發日期］
B. ［通報單位］
C. ［案情摘要］"
 */
  PROCEDURE SP_V_055(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_055 START =========');
  if I_tb_customer_after.CUSTOMER_STATUS is null
  and I_tb_customer_after.REPORT_DATE is not null
  and I_tb_customer_after.REPORT_UNIT is not null
  and I_tb_customer_after.REPORT_DESCRIPTION is not null
  then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('0918');
  end if;

  DBMS_OUTPUT.PUT_LINE('============ SP_V_055 END =========');
  end SP_V_055;


  /*
  " ﹝顧客狀態代碼］為下列任一種代碼且［案情摘要］］＝Null時，設定﹝執行結果﹞為「5735」
  A. 「00：疑似不正常」
  B. 「11：偽造」
  C. 「22：詐欺」
  D. 「33：證件曾遺失」
  E. 「40：曾有信用瑕疵」
  F. 「41：不宜接觸客群」
  G. 「64：異常交易預警」
  H. 「74：異常交易帳戶」
  I. 「91：疑遭詐騙開戶」
  J. 「99：其他」"

  */
  PROCEDURE SP_V_056(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_056 START =========');
  if I_TX_ID = 'A12301'
  and i_tb_customer_after.REPORT_DESCRIPTION is null
  and nvl(i_tb_customer_after.CUSTOMER_STATUS,' ') in ('00','11','22','33','40','41','64','74','91','99')
  then
       CIFX.PG_THROW_ERR.SP_THROW_ERR('5735');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_056 END =========');
  end SP_V_056;


 /*
 "當﹝顧客類別代碼﹞符合下列任一選項時，設定﹝執行結果﹞為「0918」
A. 「08 : QFII合格外國機構投資人」
B. 「09 : FINI外國機構投資人」
C. 「12 : 退休戶」"
 */
  PROCEDURE SP_V_057(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_057 START =========');
    if I_CERT_TYPE in ('A','E','F','G','H')
    and nvl(i_tb_customer_after.CUSTOMER_TYPE_CODE,' ') in ('08','09','12') then
           CIFX.PG_THROW_ERR.SP_THROW_ERR('0918');
    end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_057 END =========');
  end SP_V_057;


/*
﹝顧客類別代碼﹞是「10 : ＦＩＤＩ境外華僑及外國自然人投資人」且不是外國自然人，則設定﹝執行結果﹞為「$186」(回傳前端: 0918)
*/
  PROCEDURE SP_V_058(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_058 START =========');
    if I_CERT_TYPE in ('A','B','OA','OB')
    and nvl(i_tb_customer_after.CUSTOMER_TYPE_CODE,' ') = '10' then
           CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$186');
    end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_058 END =========');
  end SP_V_058;


/*
"DBU法人
﹝顧客類別代碼﹞＝「08 : ＱＦＩＩ合格外國機構投資人」或「09 :ＦＩＮＩ外國機構投資人」時，若﹝國籍分類代碼﹞、﹝利息所得稅別﹞、﹝行業編號(主計處代碼)﹞與『PT0992136交叉檢核』不符時，設定﹝執行結果﹞為「$107」(回傳前端: 0918)

『PT0992136交叉檢核』
﹝國籍分類代碼﹞/﹝利息所得稅別﹞/﹝行業編號(主計處代碼)﹞
「2 : 居留證有效期間低於一年之自然人及未取得我國證照之法人」/「2 : 外國人２０％」/「130200 : 國外非金融機構」"
*/
  PROCEDURE SP_V_059(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_059 START =========');
  if I_CERT_TYPE = 'B'
    and nvl(i_tb_customer_after.CUSTOMER_TYPE_CODE,' ') in ('08','09')
    --PT0992136交叉檢核
    and
    (nvl(i_tb_customer_after.NATIONALITY,' ') <> '2' or nvl(i_tb_customer_after.INCOME_TAX_TYPE,' ') <> '2' or nvl(i_tb_customer_after.DGBAS_INDUSTRY_CODE,' ') <> '130200' ) then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$107');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_059 END =========');
  end SP_V_059;


/*
﹝顧客類別代碼﹞＝「10 :ＦＩＤＩ境外華僑及外國自然人投資人」時，若﹝國籍分類代碼﹞、﹝利息所得稅別﹞、﹝行業編號(主計處代碼)﹞與『PT0992136交叉檢核』不符時，設定﹝執行結果﹞為「$107」(回傳前端: 0918)
﹝國籍分類代碼﹞ ﹝利息所得稅別﹞ ﹝行業編號(主計處代碼)﹞
「2 : 居留證有效期間低於一年之自然人及未取得我國證照之法人」 「2 : 外國人２０％」 「130200 : 國外非金融機構」
*/
  PROCEDURE SP_V_060(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_060 START =========');
    if I_CERT_TYPE in ('E','F','G','H')
    and nvl(i_tb_customer_after.CUSTOMER_TYPE_CODE,' ') in ('08','09')
    --PT0992136交叉檢核
    and
    (nvl(i_tb_customer_after.NATIONALITY,' ') <> '2' or nvl(i_tb_customer_after.INCOME_TAX_TYPE,' ') <> '2' or nvl(i_tb_customer_after.DGBAS_INDUSTRY_CODE,' ') <> '130200' )
    then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$107');
    end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_060 END =========');
  end SP_V_060;


/*
【顧客主檔】.【顧客類別代碼】≠﹝顧客類別代碼﹞時，需進行下列檢核：
【顧客主檔】.【顧客類別代碼】＝「04:員工」且﹝顧客類別代碼﹞≠「03:董監事」則需檢核員工存款帳戶是否已銷戶
參閱EDLS文件查詢存放款帳號資訊
A. 資料庫發生錯誤時，設定﹝執行結果﹞為「0901」
B. 若存在一筆紀錄『產品特性識別註記』＝「04: 行儲戶」且『帳戶狀態』≠「2 :結清戶」則設定﹝執行結果﹞為「3030」
*/
 PROCEDURE SP_V_061(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
    v_cursor      SYS_REFCURSOR;
    --EDLS
  v_acc_type                      varchar2(200 char):=null; -- 帳號類別
  v_account	                      varchar2(200 char):=null; -- 帳號
  v_prod_code                     varchar2(200 char):=null; -- 產品代號
  v_acc_status	                  varchar2(200 char) :=null; -- 帳戶狀態
  v_esa_acc_mark                  varchar2(200 char):=null; -- ESA帳號註記
  v_sleeping_acc_mark             varchar2(200 char):=null; -- 久未往來註記
  v_prod_individuality            varchar2(2 char):=null; -- 產品特性識別註記
  CALL_EDLS_EXCEPTION EXCEPTION;
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_061 START =========');
    if nvl(I_TB_CUSTOMER.CUSTOMER_TYPE_CODE,' ') <> nvl(I_tb_customer_after.CUSTOMER_TYPE_CODE,' ')
    and
    (nvl(I_TB_CUSTOMER.CUSTOMER_TYPE_CODE,' ') = '04' and nvl(I_tb_customer_after.CUSTOMER_TYPE_CODE,' ') <> '03' ) then
     EDLS.PG_EDLS_TO_CIF.SP_GET_CUST_ACC_INFO(I_tb_customer_after.cif_verified_id,v_cursor);
      LOOP
        FETCH v_cursor
        INTO v_acc_type ,v_account , v_prod_code, v_acc_status ,v_esa_acc_mark ,v_sleeping_acc_mark;
        EXIT WHEN v_cursor%NOTFOUND;

        SELECT (SELECT PROD_INDIVIDUALITY FROM EDLS.TB_DEPT_PROD_ATTRIBUTE WHERE PROD_CODE = v_prod_code)INTO v_prod_individuality FROM DUAL;
        IF NVL(v_prod_individuality,' ')='04' AND  NVL(v_acc_status,' ')!='2' THEN
          RAISE CALL_EDLS_EXCEPTION;
        END IF;

      END LOOP;
    end if;
  exception
   when CALL_EDLS_EXCEPTION then
   CIFX.PG_THROW_ERR.SP_THROW_ERR('3030');
   when others then
   CIFX.PG_THROW_ERR.SP_THROW_ERR('0901');

  DBMS_OUTPUT.PUT_LINE('============ SP_V_061 END =========');
  end SP_V_061;


 /*
 ﹝行業編號(主計處代碼)﹞=「061500」且﹝顧客姓名﹞未包含「籌備處」或「籌備會」
 */
 PROCEDURE SP_V_062(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_062 START =========');

  if nvl(I_tb_customer_after.DGBAS_INDUSTRY_CODE,' ') = '061500'
  and
  (REGEXP_INSTR (nvl(I_tb_customer_after.cust_name,' '), '籌備會') = 0 or REGEXP_INSTR (nvl(I_tb_customer_after.cust_name,' '), '籌備處') = 0 )
  then
   CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$210');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_062 END =========');
  end SP_V_062;


/*
『新歸戶統編』最後1碼是數字且〔顧客姓名〕包含「籌備處」或「籌備會」則設定〔執行結果〕為「7041」
*/
 PROCEDURE SP_V_063(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  v_digital_cnt integer := 0;
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_063 START =========');
  select count(1) into v_digital_cnt from dual
  where regexp_like(substr(nvl(I_tb_customer_after.cif_verified_id,' '),length(nvl(I_tb_customer_after.cif_verified_id,' '))),'[[:digit:]]');

  if  v_digital_cnt = 1
  and
  ((REGEXP_INSTR (nvl(I_tb_customer_after.cust_name,' '), '籌備會') <> 0 or REGEXP_INSTR (nvl(I_tb_customer_after.cust_name,' '), '籌備處') <> 0 )) then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('7041');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_063 END =========');
  end SP_V_063;


  /*
 〔顧客性質別〕＝「0或6」時，﹝自然人行業類別﹞為必填，未輸入則設定﹝執行結果﹞為「0910」
  */
  PROCEDURE SP_V_064(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as

  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_064 START =========');
  if nvl(I_tb_customer_after.PROPERTY_TYPE_CODE,' ') in ('0','6' )
  and I_tb_customer_after.INDUSTRY_TYPE_CODE is  null
  then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('0910');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_064 END =========');
  end SP_V_064;


  /*
  ﹝母公司統編﹞檢核
    母統編不可與子公司統編相等。﹝母公司統編﹞＝﹝銀行歸戶統編﹞時，設定﹝執行結果﹞為「7144」
  */
  PROCEDURE SP_V_065(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as

  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_065 START =========');
  if I_CERT_TYPE = 'B'
   and nvl(I_tb_customer_after.PARENT_COMPANY_CERT_NO,' ') = nvl(I_tb_customer_after.cif_verified_id,' ') then
   CIFX.PG_THROW_ERR.SP_THROW_ERR('7144');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_065 END =========');
  end SP_V_065;


  /*
  【顧客主檔】.【主經營行】≠﹝主經營行﹞時，需進行下列檢核：
  【顧客主檔】.【主經營行】≠Null且【顧客主檔】.【主經營行】≠﹝HEADER.分行代碼﹞，則設定﹝執行結果﹞為「7139」
  */
 PROCEDURE SP_V_066(
 I_INPUT_JSON IN CLOB,
 I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
 I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
 I_TX_ID IN VARCHAR2,
 I_SENDER_CODE IN VARCHAR2,
 I_CERT_TYPE IN VARCHAR2,
 I_CHANGE_TYPE IN VARCHAR2
  )as
  v_branch_code varchar2(100 char) := '';
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_066 START =========');
  v_branch_code        := json_value(I_INPUT_JSON,'$.requestBody.header.branch.branchCode');
  if nvl(I_TB_CUSTOMER.PERFORMANCE_DPT_CODE,' ') <> nvl(I_tb_customer_after.PERFORMANCE_DPT_CODE,' ')
   and I_TB_CUSTOMER.PERFORMANCE_DPT_CODE is not null and I_TB_CUSTOMER.PERFORMANCE_DPT_CODE <> v_branch_code then
   CIFX.PG_THROW_ERR.SP_THROW_ERR('7139');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_066 END =========');
  end SP_V_066;


  /*
  【顧客主檔】.【理專所屬分行】≠Null且【顧客主檔】.【理專所屬分行】≠﹝主經營行﹞，則設定﹝執行結果﹞為「7159」
  */
  PROCEDURE SP_V_067(
  I_INPUT_JSON IN CLOB,
  I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
  I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
  I_TX_ID IN VARCHAR2,
  I_SENDER_CODE IN VARCHAR2,
  I_CERT_TYPE IN VARCHAR2,
  I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_067 START =========');
  if I_TB_CUSTOMER.PROPERTY_TYPE_CODE is not null
  and nvl(I_TB_CUSTOMER.MGNT_UNIT_CODE,' ') <> nvl(I_tb_customer_after.PERFORMANCE_DPT_CODE,' ')
  then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('7159');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_067 END =========');
  end SP_V_067;


  /*
  "(1)	﹝顧客性質代碼﹞檢核
	『證號類型』與﹝顧客性質代碼﹞需符合『統編類別及顧客性質代碼定義』，否則設定［執行結果］為「$070」(回傳前端:0918)"
  */
  PROCEDURE SP_V_068(
  I_INPUT_JSON IN CLOB,
  I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
  I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
  I_TX_ID IN VARCHAR2,
  I_SENDER_CODE IN VARCHAR2,
  I_CERT_TYPE IN VARCHAR2,
  I_CHANGE_TYPE IN VARCHAR2
  )as
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_068 START =========');

  case
    when I_CERT_TYPE = 'A' and nvl(I_tb_customer_after.PROPERTY_TYPE_CODE,' ') not in ('0','6') then
      CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$070');
    when I_CERT_TYPE = 'B' and nvl(I_tb_customer_after.PROPERTY_TYPE_CODE,' ') not in ('1','2','3','4','5') then
      CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$070');
    when I_CERT_TYPE = 'E' and nvl(I_tb_customer_after.PROPERTY_TYPE_CODE,' ') not in ('0','6') then
      CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$070');
    when I_CERT_TYPE = 'F' and nvl(I_tb_customer_after.PROPERTY_TYPE_CODE,' ') not in ('0','6') then
      CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$070');
    when I_CERT_TYPE = 'G' and nvl(I_tb_customer_after.PROPERTY_TYPE_CODE,' ') not in ('0','6') then
      CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$070');
    when I_CERT_TYPE = 'H' and nvl(I_tb_customer_after.PROPERTY_TYPE_CODE,' ') not in ('0','6') then
      CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$070');
    when I_CERT_TYPE = 'O' and nvl(I_tb_customer_after.PROPERTY_TYPE_CODE,' ') not in ('0','1','2','3','4','5','6') then
      CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$070');
    else
      CIFX.PG_THROW_ERR.SP_THROW_ERR('0918%$070');
  end case;

  DBMS_OUTPUT.PUT_LINE('============ SP_V_068 END =========');
  end SP_V_068;

  /*
  ﹝顧客性質別代碼﹞＝「4:獨資戶」或「5:合夥戶」，且〔代表人統編〕的『證號類型』＝「B :營利事業」或「X :無法識別」
  */
  PROCEDURE SP_V_069(
  I_INPUT_JSON IN CLOB,
  I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
  I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
  I_TX_ID IN VARCHAR2,
  I_SENDER_CODE IN VARCHAR2,
  I_CERT_TYPE IN VARCHAR2,
  I_CHANGE_TYPE IN VARCHAR2
  )as
  v_return_code varchar2(4 char):= '';
  v_cert_type_return varchar2(2 char):= '';
  v_check_number varchar2(1 char):= '';
  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_069 START =========');
     CIFX.SP_VAL_CERTIFICATION_TYPE(
                I_FUNCTION => '1',
                I_CERT_NO => I_tb_customer_after.PRINCIPAL_CERT_NO,
                I_BIRTHDAY => null,
                O_RETURN_CODE => v_return_code,
                O_CERT_TYPE => v_cert_type_return,
                O_CHECK_NUMBER => v_check_number
              );

  if nvl(I_tb_customer_after.PROPERTY_TYPE_CODE,' ') in ('4','5')
  and v_cert_type_return in ('B','X') then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('5008%$131');
  end if;

  DBMS_OUTPUT.PUT_LINE('============ SP_V_069 END =========');
  end SP_V_069;


  /*
  自然人統編不可與服務公司統編相等。﹝服務公司統編﹞＝﹝原始身份證字號/統編﹞時，設定﹝執行結果﹞為「0918」
  */
  PROCEDURE SP_V_070(
  I_INPUT_JSON IN CLOB,
  I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
  I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
  I_TX_ID IN VARCHAR2,
  I_SENDER_CODE IN VARCHAR2,
  I_CERT_TYPE IN VARCHAR2,
  I_CHANGE_TYPE IN VARCHAR2
  )as

  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_070 START =========');
  if  nvl(I_tb_customer_after.SERVE_COMPANY_CERT_NO,' ')  =  nvl(I_tb_customer_after.CIF_ORIGINAL_ID,' ') then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('0918');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_070 END =========');
  end SP_V_070;


  /*
  當〔OTP簡訊密碼服務狀態註記〕等於「1」時此欄位需有值
  */
  PROCEDURE SP_V_071(
  I_INPUT_JSON IN CLOB,
  I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
  I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
  I_TX_ID IN VARCHAR2,
  I_SENDER_CODE IN VARCHAR2,
  I_CERT_TYPE IN VARCHAR2,
  I_CHANGE_TYPE IN VARCHAR2
  )as

  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_071 START =========');
  if  nvl(I_tb_customer_after.OTP_SERVICE,' ') <>  '1' and I_tb_customer_after.TXNP_COMM_CONTENT is null then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('07A7');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_071 END =========');
  end SP_V_071;


  /*
  非空值時前兩碼應為「09」
  */
  PROCEDURE SP_V_072(
  I_INPUT_JSON IN CLOB,
  I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
  I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
  I_TX_ID IN VARCHAR2,
  I_SENDER_CODE IN VARCHAR2,
  I_CERT_TYPE IN VARCHAR2,
  I_CHANGE_TYPE IN VARCHAR2
  )as

  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_072 START =========');
  if I_tb_customer_after.TXNP_COMM_CONTENT is not null
  and substr(I_tb_customer_after.TXNP_COMM_CONTENT,1,2) <> '09' then
   CIFX.PG_THROW_ERR.SP_THROW_ERR('0918');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_072 END =========');
  end SP_V_072;


  /*
  1. OPT行動電話不同不能提出申請
  符合〔交易序碼〕＝「TQP03002」的條件下才需執行此項目的檢核。
  若【顧客主檔】.【交易用行動電話/簡訊密碼專屬行動電話】≠「NULL」且〔簡訊密碼專屬行動電話〕≠【顧客主檔】.【交易用行動電話/簡訊密碼專屬行動電話】
  */
  PROCEDURE SP_V_073(
  I_INPUT_JSON IN CLOB,
  I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
  I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
  I_TX_ID IN VARCHAR2,
  I_SENDER_CODE IN VARCHAR2,
  I_CERT_TYPE IN VARCHAR2,
  I_CHANGE_TYPE IN VARCHAR2
  )as

  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_073 START =========');
  if I_TX_ID = 'TQP03002'
  and I_TB_CUSTOMER.TXNP_COMM_CONTENT is not null
  and nvl(I_tb_customer_after.TXNP_COMM_CONTENT,' ') <> nvl(I_TB_CUSTOMER.TXNP_COMM_CONTENT,' ') then
    CIFX.PG_THROW_ERR.SP_THROW_ERR('7313');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_073 END =========');
  end SP_V_073;

  /*
  2. OPT行動電話相同不能提出申請。
  符合〔交易序碼〕＝「NT1504」的條件下才需執行此項目的檢核。
  若〔簡訊密碼服務〕＝「2」且【顧客主檔】.【交易用行動電話/簡訊密碼專屬行動電話】≠「NULL」且〔簡訊密碼專屬行動電話〕＝【顧客主檔】.【交易用行動電話/簡訊密碼專屬行動電話】
  */
  PROCEDURE SP_V_074(
  I_INPUT_JSON IN CLOB,
  I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
  I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
  I_TX_ID IN VARCHAR2,
  I_SENDER_CODE IN VARCHAR2,
  I_CERT_TYPE IN VARCHAR2,
  I_CHANGE_TYPE IN VARCHAR2
  )as

  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_074 START =========');
  if I_TX_ID = 'NT1504'
  and I_TB_CUSTOMER.TXNP_COMM_CONTENT is not null
  and nvl(I_tb_customer_after.OTP_SERVICE,' ') = 2
  and I_TB_CUSTOMER.TXNP_COMM_CONTENT is not null
  and nvl(I_tb_customer_after.TXNP_COMM_CONTENT,' ') = nvl(I_TB_CUSTOMER.TXNP_COMM_CONTENT,' ')
  then
     CIFX.PG_THROW_ERR.SP_THROW_ERR('7102');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_074 END =========');
  end SP_V_074;


  /*
 1. OTP服務狀態使用中則不能再提出申請。
 判別〔簡訊密碼專屬行動電話〕與【顧客主檔】.【交易用行動電話/簡訊密碼專屬行動電話】是否相同
  */
  PROCEDURE SP_V_075(
  I_INPUT_JSON IN CLOB,
  I_TB_CUSTOMER IN TB_CUSTOMER%ROWTYPE,
  I_tb_customer_after IN TB_CUSTOMER%ROWTYPE,
  I_TX_ID IN VARCHAR2,
  I_SENDER_CODE IN VARCHAR2,
  I_CERT_TYPE IN VARCHAR2,
  I_CHANGE_TYPE IN VARCHAR2
  )as

  begin
  DBMS_OUTPUT.PUT_LINE('============ SP_V_075 START =========');
  if nvl(I_tb_customer_after.TXNP_COMM_CONTENT,' ') = nvl(I_TB_CUSTOMER.TXNP_COMM_CONTENT,' ') then
   CIFX.PG_THROW_ERR.SP_THROW_ERR('E059');
  end if;
  DBMS_OUTPUT.PUT_LINE('============ SP_V_075 END =========');
  end SP_V_075;

END PG_DYNC_VALI;

/
